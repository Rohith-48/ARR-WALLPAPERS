{% extends 'admin_dashboard.html' %}

{% block content %}
<style>
    .button-container {
        text-align: center;
        margin-top: 10px;
    }

    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    .overlay img {
        max-width: 90%;
        max-height: 90%;
    }
    .wallpaper-row {
        display: flex;
        margin: 10px 0;
    }

    .wallpaper-box {
        border: 5px solid orange;
        box-shadow: 0 0 10px white;
        padding: 15px;
        background-color: #fff;
        flex: 0 0 calc(25% - 20px);
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
    }

    .wallpaper-image {
        flex-grow: 1;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .wallpaper-image img {
        max-width: 100%;
        max-height: 200px; /* Adjust this as needed */
    }
</style>
<div class="content_table">
    {% if user.is_superuser %}
    <div class="title">
        <h2>View/Delete Wallpapers</h2>
    </div>
    <div class="main">
        <div class="filter-options">
            <label for="filter-type">Filter by:</label>
            <select id="filter-type">
                <option value="all">All Wallpapers</option>
                <option value="admin">Admin Uploaded</option>
                <option value="creator">Creator Uploaded</option>
            </select>
        </div>
        <div class="wallpapers">
            <div class="wallpaper-row">
                {% for wallpaper in wallpapers %}
                <div class="wallpaper-box" style="border: 5px solid orange; box-shadow: 0 0 10px white; padding: 15px; margin: 10px; background-color: #fff; width: 23%; display: inline-block;" data-uploader-type="{% if wallpaper.user.is_superuser %}admin{% else %}creator{% endif %}">
                    <div class="wallpaper-image">
                        <a href="{{ wallpaper.wallpaper_image.url }}" data-lightbox="wallpapers" data-title="{{ wallpaper.title }}">
                            <img src="{{ wallpaper.wallpaper_image.url }}" alt="{{ wallpaper.title }}" style="max-width: 100%; height: auto;">
                        </a>
                    </div>
                    <div class="wallpaper-details">
                        <h3 class="wallpaper-title">{{ wallpaper.title }}</h3>
                        <p class="wallpaper-description">{{ wallpaper.description }}</p>
                        <p class="uploader-info">Uploaded by: {{ wallpaper.user.username }}</p>
                        <p class="uploader-type">Uploader type: {% if wallpaper.user.is_superuser %}Admin{% else %}Creator{% endif %}</p>
                        <p class="upload-date">Uploaded on: {{ wallpaper.upload_date }}</p>
                        <p class="category" style="color: black;">Category: {{ wallpaper.category.name }}</p> <br><br>
                        <div class="button-container">
                            <a href="#" class="button view-button" onclick="openOverlay('{{ wallpaper.wallpaper_image.url }}')">View</a>
                            <button type="submit" class="button delete-button" form="delete-form-{{ wallpaper.id }}" onclick="confirmDelete('{{ wallpaper.title }}')">Delete</button>
                            <form id="delete-form-{{ wallpaper.id }}" method="post" action="{% url 'view_delete_wallpaper' %}" onsubmit="return confirmDelete('{{ wallpaper.title }}')">
                                {% csrf_token %}
                                <input type="hidden" name="wallpaper_id" value="{{ wallpaper.id }}">
                            </form>
                        </div>
                    </div>
                </div>
                {% if forloop.counter|divisibleby:4 and not forloop.last %}
                </div><div class="wallpaper-row">
                {% endif %}
                {% endfor %}
            </div>
        </div>
        
    </div>
</div>
{% endif %}




<div class="overlay" id="overlay" onclick="closeOverlay()">
    <img src="" alt="Wallpaper" id="overlay-image">
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function openOverlay(imageUrl) {
        document.getElementById('overlay-image').src = imageUrl;
        document.getElementById('overlay').style.display = 'flex';
    }

    function closeOverlay() {
        document.getElementById('overlay').style.display = 'none';
    }

    $(document).ready(function () {
        $('#filter-type').change(function () {
            var selectedFilter = $(this).val();

            // Show or hide wallpapers based on the filter
            $('.wallpaper-box').each(function () {
                var uploaderType = $(this).data('uploader-type');
                if (selectedFilter === 'all' || uploaderType === selectedFilter) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        });
    });
</script>
<script>
    function confirmDelete(wallpaperTitle) {
        var confirmation = confirm("Are you sure you want to delete the wallpaper titled '" + wallpaperTitle + "'?");
        return confirmation;
    }
</script>


{% endblock %}