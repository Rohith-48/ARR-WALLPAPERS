{% extends 'index.html' %}

{% block content %}
<style>
    .container {
        background-color: rgb(0, 0, 0);
    }

.liked-wallpaper {
    display: block; /* Make each liked wallpaper a block-level element */
    margin-bottom: 20px; /* Add some space between liked wallpapers */
}

/* Optional: Add styling for the liked wallpaper titles and images */
.liked-wallpaper h2 {
    font-size: 18px;
    margin-top: 10px;
    margin-bottom: 5px;
}

.liked-wallpaper img {
    max-width: 100%;
    height: auto;
}

</style>
<div class="container">
    <h1>Liked Wallpapers</h1>
    <!-- Liked Wallpapers Section -->
    <section id="liked-wallpapers-section">
        {% for wallpaper in liked_wallpapers %}
        <div class="liked-wallpaper">
            <h2>{{ wallpaper.title }}</h2>
            <!-- Use the image URL to display the image -->
            <img src="{{ wallpaper.image_url }}" alt="{{ wallpaper.title }}">
        </div>
        {% endfor %}
    </section>
</div>

<script>
    // Function to get a cookie by name
    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) return parts.pop().split(";").shift();
    }

    document.addEventListener("DOMContentLoaded", function () {
        // Retrieve the liked wallpaper IDs from the cookie
        var likedWallpaperIds = JSON.parse(getCookie("likedWallpapers")) || [];

        if (likedWallpaperIds.length === 0) {
            var messageElement = document.createElement("p");
            messageElement.textContent = "You haven't liked any wallpapers yet.";
            document.getElementById("liked-wallpapers-section").appendChild(messageElement);
        } else {
            fetch("/liked_wallpapers/?likedWallpapers=" + JSON.stringify(likedWallpaperIds))
                .then(response => response.json())
                .then(data => {
                    if (data.likedWallpapers.length === 0) {
                        var messageElement = document.createElement("p");
                        messageElement.textContent = "No liked wallpapers found.";
                        document.getElementById("liked-wallpapers-section").appendChild(messageElement);
                    } else {
                        var likedWallpapersContainer = document.createElement("div");
                        likedWallpapersContainer.id = "liked-wallpapers-container";
                        document.getElementById("liked-wallpapers-section").appendChild(likedWallpapersContainer);
                        data.likedWallpapers.forEach(function (wallpaper) {
                            var wallpaperElement = document.createElement("div");
                            wallpaperElement.className = "liked-wallpaper";
                            wallpaperElement.innerHTML = `
                            <div>
                                <h2>${wallpaper.title}</h2>
                            </div>
                            <div>
                                <!-- Use the image URL to display the image -->
                                <img src="${wallpaper.image_url}" alt="${wallpaper.title}">
                            </div>
                            `;
                            likedWallpapersContainer.appendChild(wallpaperElement);
                        });
                    }
                })
                .catch(error => {
                    console.error(error);
                });
        }
    });
</script>

{% endblock %}
