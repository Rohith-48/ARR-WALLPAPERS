{% extends 'index.html' %}

{% block content %}
<style>
    .container {
        text-align: center;
        max-width: 1200px;
        margin: 0 auto;
        background-color: black;
    }

    /* Add Masonry CSS */
    #liked-wallpapers-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 10px;
    }

    .liked-wallpaper {
        position: relative;
        overflow: hidden;
        margin-bottom: 10px;
        border-radius: 5px;
        width: 100%; 
        height: auto;
    }
    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(158, 155, 155, 0.067);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .liked-wallpaper:hover .overlay {
        opacity: 1;
    }

    .title {
        color: white;
        font-size: 14px;
        text-align: left;
        position: absolute;
        top: 10px;
        left: 10px;
        padding: 5px;
    }

    .wallpaper-image {
        max-width: 100%;
        height: auto;
    }
</style>

<div class="container">
    <h1 style="color: white;">Liked Wallpapers</h1>
    <div id="liked-wallpapers-container">
        {% for wallpaper in wallpapers %}
        <div class="liked-wallpaper">
            <div class="overlay">
                <h2 class="title">{{ wallpaper.title }}</h2>
            </div>
            <img src="{{ wallpaper.image_url }}" alt="{{ wallpaper.title }}" class="wallpaper-image">
        </div>
        {% if forloop.counter|divisibleby:4 and not forloop.last %}
        <div style="width: 100%; clear: both;"></div>
        {% endif %}
        {% endfor %}
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>
<script>
    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) return parts.pop().split(";").shift();
    }

    document.addEventListener("DOMContentLoaded", function () {
        var likedWallpaperIds = JSON.parse(getCookie("likedWallpapers")) || [];

        if (likedWallpaperIds.length === 0) {
            var messageElement = document.createElement("p");
            messageElement.textContent = "You haven't liked any wallpapers yet.";
            document.getElementById("liked-wallpapers-section").appendChild(messageElement);
        } else {
            fetch("/liked_wallpapers/?likedWallpapers=" + JSON.stringify(likedWallpaperIds))
                .then(response => response.json())
                .then(data => {
                    if (data.likedWallpapers.length === 0) {
                        var messageElement = document.createElement("p");
                        messageElement.textContent = "No liked wallpapers found.";
                        document.getElementById("liked-wallpapers-section").appendChild(messageElement);
                    } else {
                        var likedWallpapersContainer = document.createElement("div");
                        likedWallpapersContainer.id = "liked-wallpapers-container";
                        document.getElementById("liked-wallpapers-section").appendChild(likedWallpapersContainer);
                        data.likedWallpapers.forEach(function (wallpaper) {
                            var wallpaperElement = document.createElement("div");
                            wallpaperElement.className = "liked-wallpaper";
                            wallpaperElement.innerHTML = `
                            <div>
                                <h2>${wallpaper.title}</h2>
                            </div>
                            <div>
                                <!-- Use the image URL to display the image -->
                                <img src="${wallpaper.image_url}" alt="${wallpaper.title}">
                            </div>
                            `;
                            likedWallpapersContainer.appendChild(wallpaperElement);
                        });
                    }
                })
                .catch(error => {
                    console.error(error);
                });
        }
    });
</script>

{% endblock %}
